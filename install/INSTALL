#############################################################################
# phpDiveLog                                    (c) 2004 by Itzchak Rehberg #
# written by Itzchak Rehberg <izzysoft@qumran.org>                          #
# http://www.qumran.org/homes/izzy/                                         #
# ------------------------------------------------------------------------- #
# This program is free software; you can redistribute and/or modify it      #
# under the terms of the GNU General Public License (see doc/LICENSE)       #
# ------------------------------------------------------------------------- #
# Installation instructions for the patient ;)                              #
#############################################################################
# $Id$

===[ TOC ]=========================================================[ TOC ]===
1. Aqua DiveLog
1.1. Installation
1.2. Conduit configuration
1.3. Script configuration
2. phpDiveLog
2.1. Installing
2.2. Configuration
2.3. Updating
3. Diver and dive data
3.1. Set up a diver
3.2. The divers system.conf
3.3. The divers diver.conf
3.4. Data conversion and transfer

===[ Aqua DiveLog ]=======================================[ Aqua DiveLog ]===

1.1. Installation
-----------------
- copy the contents of the install/adl/template/ dir to ADLs template/ dir
- copy the contents of the install/adl/ dir to ADLs directory

1.2. Conduit configuration
--------------------------
This takes place in the divelog.ini file as described in the Aqua DiveLog
documentation (see there for detailed description). In this little document
I will assume that you only change the following parameters:
- TablePDBFile : location and name of your AquaPalm-TableDB.pdb file
- DivePDBFile  : location and name of your AquaPalm-DiveDB.pdb file
I will not explain all combinations of the other parameters - this is not the
topic of this short documentation, but to get you started quick. If you want/
need to change more, you will have to find out yourself ;)

1.3. Script configuration
-------------------------
The script is to be configured in the divelog_conduit.sh itself. In the head
of the file you find the configuration section: Even if you are not familiar
with Shell scripts, it should be easy for you to set up. One hint: never place
spaces around the "=" sign or it will not work. The following options will
need your attention:
- LOGDIR     : if you followed my advice in 1.2., you can leave it as is. If
               not: this value has to match the LogBookPath in the divelog.ini
- PDLBASE    : the divers directory of your phpDiveLog installation, i.e.
               where the subdirectories data/ and images/ reside. Will
               certainly look like <PDL root dir>/diver/<nickname> - see
               "Diver and dive data" below for details.
- UNITS      : which kind of units you prefer - can be set either to "metric",
               "imperial" or "bothunits"
- DATEFORMAT : just for the "progress display" on the screen to give you an
               idea how log which step took ;)

===[ phpDiveLog ]==========================================[ phpDiveLog ]===

2.1. Installation
-----------------
- copy everything except the install/ subdir into your web tree
- if you don't want to start with the demo data, remove all files from
  the data/ , fotos/ and images/ subdir

2.2. Configuration
------------------
All the "user-based" configuration takes place in the inc/config.inc file. I
strongly recommend not to try some configuration in other places (which would
make it harder for YOU to update your installation later) - if you miss some
configuration option, just let me know and I will see if and how I can
implement this.

Each configuration option is documented within the config file, so
"QuickStarters" can skip here to the next section. For all others: here comes
a short documentation for the available parameters and their effects:
- $database["type"]   : right now you can set this to "csv" only. In the
                        future, there my be more formats available, such as
                        UDDF for the Universal Dive Data Format (again a file),
                        or even "real databases" such as MySQL, PostgreSQL, etc.
- $display_limit      : with pages containing lists, as e.g. the sitelist,
                        this value will advise PDL how many entries (i.e.
                        table data rows) to display per page. This saves you
                        from scrolling through long pages - but of course
                        you can set this to e.g. 999999999 and everything
                        will fit on one page (but not necessarily one screen).
- $template_set       : to which template set PDL should default. Right now
                        the values "aqua" and "default" are available. The
                        visitor can overwrite this value (for his/her browser
                        session only, of course) by selecting a different
                        template set on the preferences page.
- $lang               : the default language to use. This is a 2 character
                        ISO code, like "en" for English or "de" for German.
                        You can set this to any language you like - if no
                        translations are found, PDL will fall back to English.
                        Of course you can create your own translations, which
                        will be discussed at another place (OT here).
- $title              : for now the site name to be displayed in the browsers
                        title bar. At the end of this, some page information
                        will be added: if you e.g. set the title to "MyDiveLog",
                        by browsing the dive #5 the browsers title probably
                        looks like "MyDiveLog: Dive# 5" - where "Dive" could
                        be localized even...
- $enable_index       : whether visitors should be allowed to browse the
                        buddylist. Needs to be set to "TRUE" if you want to
                        use $defaultpage="index" (see below).
- $default_page       : what to do if there's no diver specified with the
                        URL (and thus PDL does not know where to look for the
                        data - normally this has to be done on the URL with
                        the "diver=nickname" parameter)? The options are:
                        * "user"  - we have a default user (see $default_user)
                        * "index" - display the index page with available nicks
                        * "error" - display an error message to the visitor
- $default_user       : only evaluated if $default_page="user": which is the
                        default logbook we should route the request to? Must
                        be a valid account (see "set up a diver"), otherwise
                        results in $default_page="error".
- $allow_override     : some configuration values can be defined on a per-
                        logbook-base, so each diver can provide his/her
                        default preferences to it. We do not want them to
                        mess up things, so here we define which parameters
                        may be overridden by the diver/*/system.conf file.
                        The value of this parameter is a space separated
                        list of options. As shipped, these is set to
                        "title lang display_limit template_set", which seems to
                        me being a good choice.

2.3. Updating
-------------
When updating, you generally follow the steps 2.1 and 2.2 above - but probably
you will NOT want to copy the contents of the data/ subdir from tha archive
to not overwrite your own data.

===[ Diver & Dive Data ]============================[ Diver & Dive Data ]===

3.1. Set up a diver
-------------------
All data now are located in the divers directory. This is a kind of "home
directory" located below the diver/ directory. In order to set up an account,
just create a new directory here with a name of your choice - a good
recommendation would be the divers nick name in lower case. This "home
directory" then must have the following subdirectory structure:
- data (here go the *.csv data files to)
- fotos
  - dive (fotos of the dives)
  - site (fotos of the dive sites)
- images (here go the dive profiles to)
To have your Aqua DiveLog data transfered to the right directory, you may
want to set up PDLBASE in the conduit script accordingly (see above).

3.2. The divers system.conf
---------------------------
Optionally, each diver can override some of the systems default settings by
putting a file named "system.conf" in his/her "home directory". The syntax
of this file is easy: one parameter per line in the form "var=value". Empty
lines and lines beginning with a "#" are ignored. Which system defaults are
allowed to be overriden is defined in the inc/config.inc file by the parameter
$allow_override (see above in the phpDiveLog configuration description).

One additional parameter in the system.conf is "personal". It defines whether
the diver wants to display his/her personal data (see diver.conf) or not. If
this parameter is missing (or commented out), noone will be able to browse
them via the "person.php" page, even if a complete diver.conf exists. The same
applies if it is set to "0". Set "personal = 1" if you want the page to be
displayed.

3.3. The divers diver.conf
--------------------------
This file, if available, must reside in the same directory as the system.conf
file (see above). It is intended to provide data for the divers personal page,
i.e. name and place of living as well as certifications.

The diver.conf is divided into several blocks - block names are encloses in
square brackets. If you do not want to provide data for a specific block at
all, you may just completely remove it (or comment it out) at all.

The [person] block, as the name suggests contains the personal data. Available
options in this block are name, firstname, country, state, city and status
(where "status" means your highest certification, e.g. AOWD, DM or Instructor).
You can include a photo of yours using the "foto" option also available in this
block. The image used here must be stored in the diver/*/fotos/person/
subdirectory. If you don't specify one, a "dummy" will be used instead.
If you want to omit something, just delete or comment out that line.

With the [certification] block, there are stronger rules to observe. Data for
a certification must include the course (i.e. the certification - makes no
sense without ;) and may include the date and place where it was gained. Thus
we have three items that belong together, and we may have multiple of this
groups. So we group them together by arrays. The consequence is you have to
keep the three items together if they belong together, and you must not miss
the square brackets at the end of the options name. Plus you have to include
either none or all three options - if you don't want to publish e.g. the date,
just leave the parameter blank. Otherwise, if you specify it for the next
course, the parser will count it to the previous ;) Available options in this
block are course[], date[] and place[].

3.4. Data conversion and transfer
---------------------------------
In order to get you web installation running with useful data, you now only
need to change to the conduit directory and run the divelog_conduit.sh script.
Provided you followed all above steps carefully, your dive data should then
be displayed when you invoke the URL to your PDL installation.

If you re-organized some dive data (especially renumbering the dives and/or
sites), you may need to clean the images/ directory (which contains the dive
profile images). I will think a bit about it - maybe I can include that with
the divelog_conduit.sh script to save you this work...

===[ EOF ]========================================================[ EOF ]===